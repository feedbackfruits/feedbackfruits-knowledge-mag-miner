"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const Context = require("../context");
function fieldNameToWikiId(name) {
    return `${name[0].toUpperCase()}${name.slice(1)}`.replace(/ /g, '_');
}
function paperToQuad(entity) {
    let { Id: id, Ti: title, E: metadataStr, AA: authors, 'F': entities } = entity;
    console.log('Parsing metadata.');
    let metadata = JSON.parse(metadataStr);
    let { DN: displayName, D: description, } = metadata;
    let subject = `<http://academic.microsoft.com/#/detail/${id}>`;
    let quads = [
        { subject, predicate: Context.name, object: displayName },
        description && { subject, predicate: Context.description, object: description },
        { subject, predicate: Context.type, object: Context.Knowledge.Resource },
        { subject, predicate: Context.type, object: Context.DigitalDocument },
        { subject, predicate: Context.type, object: Context.ScholarlyArticle },
    ].filter(x => x);
    if (authors) {
        quads = [].concat(quads, authors.map(author => {
            let iri = `<http://academic.microsoft.com/#/detail/${author.AuId}>`;
            return [
                { subject, predicate: Context.author, object: iri },
                { subject: iri, predicate: Context.type, object: Context.Person },
                { subject: iri, predicate: Context.name, object: author.DAuN },
            ];
        }).reduce((memo, x) => memo.concat(x), []));
    }
    if (entities && entities.length) {
        quads = [].concat(quads, entities.map(about => {
            let iri = `<http://dbpedia.org/resource/${fieldNameToWikiId(about.FN)}>`;
            return { subject, predicate: Context.about, object: iri };
        }));
    }
    return quads;
}
exports.paperToQuad = paperToQuad;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicGFwZXIuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi9zcmMvdHlwZXMvcGFwZXIudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUFFQSxzQ0FBc0M7QUFFdEMsMkJBQTJCLElBQUk7SUFDN0IsTUFBTSxDQUFDLEdBQUcsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDLFdBQVcsRUFBRSxHQUFHLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxPQUFPLENBQUMsSUFBSSxFQUFFLEdBQUcsQ0FBQyxDQUFDO0FBQ3ZFLENBQUM7QUFFRCxxQkFBNEIsTUFBTTtJQUNoQyxJQUFJLEVBQ0YsRUFBRSxFQUFFLEVBQUUsRUFDTixFQUFFLEVBQUUsS0FBSyxFQUNULENBQUMsRUFBRSxXQUFXLEVBQ2QsRUFBRSxFQUFFLE9BQU8sRUFDWCxHQUFHLEVBQUUsUUFBUSxFQUNkLEdBQUcsTUFBTSxDQUFDO0lBRVgsT0FBTyxDQUFDLEdBQUcsQ0FBQyxtQkFBbUIsQ0FBQyxDQUFDO0lBQ2pDLElBQUksUUFBUSxHQUFHLElBQUksQ0FBQyxLQUFLLENBQUMsV0FBVyxDQUFDLENBQUM7SUFFdkMsSUFBSSxFQUNGLEVBQUUsRUFBRSxXQUFXLEVBQ2YsQ0FBQyxFQUFFLFdBQVcsR0FDZixHQUFHLFFBQVEsQ0FBQztJQUViLElBQUksT0FBTyxHQUFHLDJDQUEyQyxFQUFFLEdBQUcsQ0FBQztJQUMvRCxJQUFJLEtBQUssR0FBRztRQUNWLEVBQUUsT0FBTyxFQUFFLFNBQVMsRUFBRSxPQUFPLENBQUMsSUFBSSxFQUFFLE1BQU0sRUFBRSxXQUFXLEVBQUU7UUFDekQsV0FBVyxJQUFJLEVBQUUsT0FBTyxFQUFFLFNBQVMsRUFBRSxPQUFPLENBQUMsV0FBVyxFQUFFLE1BQU0sRUFBRSxXQUFXLEVBQUU7UUFFL0UsRUFBRSxPQUFPLEVBQUUsU0FBUyxFQUFFLE9BQU8sQ0FBQyxJQUFJLEVBQUUsTUFBTSxFQUFFLE9BQU8sQ0FBQyxTQUFTLENBQUMsUUFBUSxFQUFFO1FBQ3hFLEVBQUUsT0FBTyxFQUFFLFNBQVMsRUFBRSxPQUFPLENBQUMsSUFBSSxFQUFFLE1BQU0sRUFBRSxPQUFPLENBQUMsZUFBZSxFQUFFO1FBQ3JFLEVBQUUsT0FBTyxFQUFFLFNBQVMsRUFBRSxPQUFPLENBQUMsSUFBSSxFQUFFLE1BQU0sRUFBRSxPQUFPLENBQUMsZ0JBQWdCLEVBQUU7S0FHdkUsQ0FBQyxNQUFNLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDO0lBRWpCLEVBQUUsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUM7UUFDWixLQUFLLEdBQUcsRUFBRSxDQUFDLE1BQU0sQ0FBQyxLQUFLLEVBQUUsT0FBTyxDQUFDLEdBQUcsQ0FBQyxNQUFNO1lBQ3pDLElBQUksR0FBRyxHQUFHLDJDQUEyQyxNQUFNLENBQUMsSUFBSSxHQUFHLENBQUM7WUFDcEUsTUFBTSxDQUFDO2dCQUNMLEVBQUUsT0FBTyxFQUFFLFNBQVMsRUFBRSxPQUFPLENBQUMsTUFBTSxFQUFFLE1BQU0sRUFBRSxHQUFHLEVBQUU7Z0JBRW5ELEVBQUUsT0FBTyxFQUFFLEdBQUcsRUFBRSxTQUFTLEVBQUUsT0FBTyxDQUFDLElBQUksRUFBRSxNQUFNLEVBQUUsT0FBTyxDQUFDLE1BQU0sRUFBRTtnQkFDakUsRUFBRSxPQUFPLEVBQUUsR0FBRyxFQUFFLFNBQVMsRUFBRSxPQUFPLENBQUMsSUFBSSxFQUFFLE1BQU0sRUFBRSxNQUFNLENBQUMsSUFBSSxFQUFFO2FBRS9ELENBQUM7UUFDSixDQUFDLENBQUMsQ0FBQyxNQUFNLENBQUMsQ0FBQyxJQUFJLEVBQUUsQ0FBQyxLQUFLLElBQUksQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDLEVBQUUsRUFBRSxDQUFDLENBQUMsQ0FBQztJQUM5QyxDQUFDO0lBRUQsRUFBRSxDQUFDLENBQUMsUUFBUSxJQUFJLFFBQVEsQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDO1FBQ2hDLEtBQUssR0FBRyxFQUFFLENBQUMsTUFBTSxDQUFDLEtBQUssRUFBRSxRQUFRLENBQUMsR0FBRyxDQUFDLEtBQUs7WUFDekMsSUFBSSxHQUFHLEdBQUcsZ0NBQWdDLGlCQUFpQixDQUFDLEtBQUssQ0FBQyxFQUFFLENBQUMsR0FBRyxDQUFDO1lBRXpFLE1BQU0sQ0FBQyxFQUFFLE9BQU8sRUFBRSxTQUFTLEVBQUUsT0FBTyxDQUFDLEtBQUssRUFBRSxNQUFNLEVBQUUsR0FBRyxFQUFFLENBQUM7UUFDNUQsQ0FBQyxDQUFDLENBQUMsQ0FBQztJQUNOLENBQUM7SUFFRCxNQUFNLENBQUMsS0FBSyxDQUFDO0FBQ2YsQ0FBQztBQW5ERCxrQ0FtREMifQ==